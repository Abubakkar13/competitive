0000 3 0 0 0 = i%8 + i<4 + i%4 + i<2
0001 2 1 0 0 = i%8 + i<4 + i%4 + i<2
0010 1 1 1 0 = 
0011 1 1 0 1
0100 1 1 1 0
0101 0 2 1 0
0110 0 1 1 1
0111 0 1 0 2
1000 2 0 1 0
1001 1 1 1 0
1010 0 1 2 0
1011 0 1 1 1
1100 1 0 1 1
1101 0 1 1 1
1110 0 0 1 2
1111 0 0 0 3

000 2 0 0 0 = i%4 + i<2 | (i-1)%4 + (i<4 && i>=2)
001 1 1 0 0 = i%4 + i<2
010 0 1 1 0 = i%4 + i<2
011 0 1 0 1 = i%4
100 1 0 1 0 = i%4
101 0 1 1 0 = i%4
110 0 0 1 1 = i%4
111 0 0 0 2 = i%4

00 1 0 0 0
01 0 1 0 0
10 0 0 1 0
11 0 0 0 1

rr rb bb bb br

1 1 1 2

wrong rr = 3 * 4! = 72
wrong bb = 2 * 2 * 4! = 96 - (2*1)